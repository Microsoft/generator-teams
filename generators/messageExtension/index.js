module.exports=function(e){var t={};function s(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,s),o.l=!0,o.exports}return s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(i,o,function(t){return e[t]}.bind(null,o));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=26)}([function(e,t){e.exports=require("path")},function(e,t){e.exports=require("yeoman-generator")},function(e,t){e.exports=require("lodash")},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(4);let o=s(0);const n="package.json";t.Yotilities=class{static validateUrl(e){return/(https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)}static fixFileNames(e,t){if(void 0!==e){var s=o.basename(e);if("_"===s[0]){e="."+s.substr(1);var i=o.dirname(e);e=o.join(i,e)}for(var n in t)t.hasOwnProperty(n)&&"string"==typeof t[n]&&(e=e.replace(new RegExp("{"+n+"}","g"),t[n]))}return e}static addAdditionalDeps(e,t){var s=t.readJSON(n);e.forEach(e=>{s.dependencies[e[0]]=e[1]}),t.writeJSON(n,s)}static insertTsExportDeclaration(e,t,s,o){let n=o.read(e);const a=i.createSourceFile(e,n,i.ScriptTarget.ES5,!0,i.ScriptKind.TS),r=i.createExportDeclaration(void 0,void 0,void 0,i.createLiteral(t));void 0!==s&&i.addSyntheticLeadingComment(r,i.SyntaxKind.SingleLineCommentTrivia,` ${s}`);const p=i.updateSourceFileNode(a,[...a.statements,r]),c=i.createPrinter({newLine:i.NewLineKind.LineFeed,removeComments:!1});o.write(e,c.printFile(p))}}},function(e,t){e.exports=require("typescript")},function(e,t){e.exports=require("yosay")},function(e,t){e.exports=require("guid")},,,,,,,,,,,,,,,,,,,,function(e,t,s){e.exports=s(27)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(28);e.exports=i.MessageExtensionGenerator},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(1),o=s(2),n=s(3);s(5),s(0);let a=s(6);t.MessageExtensionGenerator=class extends i{constructor(e,t){super(e,t),t.force=!0,this.options=t.options,this.desc("Adds a Message Extension to a Microsoft Teams Apps project")}prompting(){if(this.options.messageExtension)return this.prompt([{type:"list",name:"messageExtensionType",message:"What type of Message Extension would you like to create ",default:e=>"botframework"==this.options.botType?"existing":"new",choices:e=>{var t=[];return t.push({name:"For a Bot hosted somewhere else",value:"external"}),"botframework"==this.options.botType?t.push({name:"For the Bot created in this project",value:"existing"}):t.push({name:"For a new Bot",value:"new"}),t}},{type:"input",name:"messageExtensionId",message:e=>"I need the Microsoft App ID for the Bot used by the Message Extension. ",default:e=>a.EMPTY,validate:e=>a.isGuid(e),when:e=>"existing"!==e.messageExtensionType},{type:"input",name:"messageExtensionName",message:"What is the name of your Message Extension command?",default:this.options.title+" Message Extension",validate:e=>e.length>0},{type:"input",name:"messageExtensionDescription",message:"Describe your Message Extension command?",default:`Description of ${this.options.title} message extension`,validate:e=>e.length>0}]).then(e=>{this.options.messageExtensionId=e.messageExtensionId,this.options.messageExtensionType=e.messageExtensionType,this.options.messageExtensionTitle=e.messageExtensionName,this.options.messageExtensionDescription=e.messageExtensionDescription,this.options.messageExtensionName=o.camelCase(e.messageExtensionName),this.options.messageExtensionClassName=this.options.messageExtensionName.charAt(0).toUpperCase()+this.options.messageExtensionName.slice(1),"new"==e.messageExtensionType?(this.options.bot=!0,this.options.botid=e.messageExtensionId,this.options.botType="botframework",this.options.botTitle=e.messageExtensionName+" Bot",this.options.botName=o.camelCase(this.options.botTitle),this.options.botClassName=this.options.botName.charAt(0).toUpperCase()+this.options.botName.slice(1)):"existing"==e.messageExtensionType&&(this.options.messageExtensionId=this.options.botid),this.options.reactComponents=!0})}writing(){if(this.options.messageExtension){let t="src/manifest/manifest.json";var e=this.fs.readJSON(t);e.composeExtensions||(e.composeExtensions=[]),e.composeExtensions.push({botId:this.options.messageExtensionId,canUpdateConfiguration:!0,commands:[{id:this.options.messageExtensionName,title:this.options.messageExtensionTitle,description:"Add a clever description here",initialRun:!0,parameters:[{name:"parameter",description:"Description of the parameter",title:"Parameter"}]}]}),this.fs.writeJSON(t,e);let s=[];s.push("src/app/scripts/{messageExtensionName}Config.tsx","src/app/web/{messageExtensionName}Config.html"),s.forEach(e=>{this.fs.copyTpl(this.templatePath(e),n.Yotilities.fixFileNames(e,this.options),this.options)}),n.Yotilities.addAdditionalDeps([["msteams-ui-components-react","^0.7.3"],["react","^16.1.0"],["@types/react","16.4.7"],["react-dom","^16.2.0"],["file-loader","1.1.11"],["typestyle","1.5.1"]],this.fs),n.Yotilities.insertTsExportDeclaration("src/app/scripts/client.ts",`./${this.options.messageExtensionName}Config`,`Automatically added for the ${this.options.messageExtensionName} message extension`,this.fs)}}}}]);